"use strict";(self.webpackChunkgame_tavern=self.webpackChunkgame_tavern||[]).push([[349],{52713:(O,m,t)=>{t.d(m,{r:()=>f});var e=t(67294),n=t(16607),l=t(45697),g=t.n(l),E=t(99168);function c(u,r,a){if(!u||!r)return{display:"none"};const{x:s,y:o}=a;return{transform:`translate(${s}px, ${o}px)`}}function f({renderItem:u}){const{itemType:r,isDragging:a,item:s,initialOffset:o,currentOffset:w,mouseOffset:p}=(0,E.useDragLayer)(y=>({item:y.getItem(),itemType:y.getItemType(),initialOffset:y.getInitialSourceClientOffset(),currentOffset:y.getSourceClientOffset(),isDragging:y.isDragging(),mouseOffset:y.getClientOffset()}));return a?e.createElement(n.x,{height:"100%",left:0,position:"fixed",pointerEvents:"none",top:0,zIndex:100,width:"100%"},e.createElement(n.x,{style:c(o,w,p)},u({type:r,item:s}))):null}f.propTypes={renderItem:g().func.isRequired}},75021:(O,m,t)=>{t.d(m,{q:()=>g});var e=t(67294),n=t(80621),l=t(88767);function g({enabled:E}={enabled:!0}){const{get:c}=(0,n.useFetchClient)(),{data:f,isError:u,isLoading:r}=(0,l.useQuery)(["ee","license-limit-info"],async()=>{const{data:{data:o}}=await c("/admin/license-limit-information");return o},{enabled:E}),a=e.useMemo(()=>f??{},[f]),s=e.useCallback(o=>(a?.features??[]).find(p=>p.name===o)?.options??{},[a?.features]);return{license:a,getFeature:s,isError:u,isLoading:r}}},43390:(O,m,t)=>{t.d(m,{eJ:()=>D,lx:()=>I,h4:()=>v,fC:()=>x});var e=t(67294),n=t(71590),l=t(40720),g=t(34726),E=t(90731),c=t(80621),f=t(97695),u=t(86896),r=t(52713),a=t(86978),s=t(96987),o=t(10574),w=t(58471),p=t(45697),y=t.n(p),A=t(54863);const W=(0,A.default)(s.k)`
  svg path {
    fill: ${({theme:T})=>T.colors.neutral600};
  }
`;function L({name:T}){return e.createElement(s.k,{background:"primary100",borderStyle:"dashed",borderColor:"primary600",borderWidth:"1px",gap:3,hasRadius:!0,padding:3,shadow:"tableShadow",width:(0,c.pxToRem)(300)},e.createElement(W,{alignItems:"center",background:"neutral200",borderRadius:"50%",height:6,justifyContent:"center",width:6},e.createElement(w.Z,{width:`${8/16}rem`})),e.createElement(o.Z,{fontWeight:"bold"},T))}L.propTypes={name:y().string.isRequired};function S({type:T,item:h}){switch(T){case a.uL.STAGE:return e.createElement(L,{...h});default:return null}}function I(){return e.createElement(r.r,{renderItem:S})}function x({children:T}){return e.createElement(n.A,null,e.createElement(l.o,{tabIndex:-1},e.createElement(g.D,null,T)))}function D({href:T}){const{formatMessage:h}=(0,u.Z)();return e.createElement(c.Link,{startIcon:e.createElement(f.Z,null),to:T},h({id:"global.back",defaultMessage:"Back"}))}function v({title:T,subtitle:h,navigationAction:R,primaryAction:C}){return e.createElement(e.Fragment,null,e.createElement(c.SettingsPageTitle,{name:T}),e.createElement(E.T,{navigationAction:R,primaryAction:C,title:T,subtitle:h}))}},38705:(O,m,t)=>{t.d(m,{uT:()=>S,fC:()=>D,Dx:()=>L});var e=t(67294),n=t(10574),l=t(96987),g=t(74622),E=t(71543),c=t(16607),f=t(96208),u=t(94101),r=t(35771),a=t(45697),s=t.n(a),o=t(86896),w=t(54863);const p=t.p+"0cd5f8915b265d5b1856.png",y="limits-title",A="https://strapi.io/pricing-cloud",W="https://strapi.io/contact-sales";function L({children:v}){return e.createElement(n.Z,{variant:"alpha",id:y},v)}L.propTypes={children:s().node.isRequired};function S({children:v}){return e.createElement(n.Z,{variant:"omega"},v)}S.propTypes={children:s().node.isRequired};function I(){const{formatMessage:v}=(0,o.Z)();return e.createElement(l.k,{gap:2,paddingTop:4},e.createElement(u.Q,{variant:"default",isExternal:!0,href:A},v({id:"Settings.review-workflows.limit.cta.learn",defaultMessage:"Learn more"})),e.createElement(u.Q,{variant:"tertiary",isExternal:!0,href:W},v({id:"Settings.review-workflows.limit.cta.sales",defaultMessage:"Contact Sales"})))}const x=w.default.img`
  // Margin top|right reverse the padding of ModalBody
  margin-right: ${({theme:v})=>`-${v.spaces[7]}`};
  margin-top: ${({theme:v})=>`-${v.spaces[7]}`};
  width: 360px;
`;function D({children:v,isOpen:T,onClose:h}){const{formatMessage:R}=(0,o.Z)();return T?e.createElement(g.P,{labelledBy:y},e.createElement(E.f,null,e.createElement(l.k,{gap:2,paddingLeft:7,position:"relative"},e.createElement(l.k,{alignItems:"start",direction:"column",gap:2,width:"60%"},v,e.createElement(I,null)),e.createElement(l.k,{justifyContent:"end",height:"100%",width:"40%"},e.createElement(x,{src:p,"aria-hidden":!0,alt:"",loading:"lazy"}),e.createElement(c.x,{display:"flex",position:"absolute",right:0,top:0},e.createElement(f.h,{icon:e.createElement(r.Z,null),"aria-label":R({id:"global.close",defaultMessage:"Close"}),onClick:h})))))):null}D.defaultProps={isOpen:!1},D.propTypes={children:s().node.isRequired,isOpen:s().bool,onClose:s().func.isRequired}},86978:(O,m,t)=>{t.d(m,{$k:()=>u,Ef:()=>w,FT:()=>s,Nj:()=>f,Ot:()=>c,VS:()=>r,_X:()=>p,gu:()=>l,lv:()=>a,qZ:()=>g,sN:()=>n,uL:()=>o,x4:()=>E});var e=t(12255);const n="settings_review-workflows",l="Settings/Review_Workflows/RESET_WORKFLOW",g="Settings/Review_Workflows/SET_WORKFLOW",E="Settings/Review_Workflows/WORKFLOW_DELETE_STAGE",c="Settings/Review_Workflows/WORKFLOW_ADD_STAGE",f="Settings/Review_Workflows/WORKFLOW_UPDATE_STAGE",u="Settings/Review_Workflows/WORKFLOW_UPDATE_STAGE_POSITION",r="Settings/Review_Workflows/WORKFLOW_UPDATE",a={primary600:"Blue",primary200:"Lilac",alternative600:"Violet",alternative200:"Lavender",success600:"Green",success200:"Pale Green",danger500:"Cherry",danger200:"Pink",warning600:"Orange",warning200:"Yellow",secondary600:"Teal",secondary200:"Baby Blue",neutral400:"Gray",neutral0:"White"},s=e.W.colors.primary600,o={STAGE:"stage"},w="numberOfWorkflows",p="stagesPerWorkflow"},52258:(O,m,t)=>{t.d(m,{n:()=>l});var e=t(80621),n=t(88767);function l(g={}){const{get:E}=(0,e.useFetchClient)(),{id:c="",...f}=g,u={populate:"stages"},{data:r,isLoading:a,status:s,refetch:o}=(0,n.useQuery)(["review-workflows","workflows",c],async()=>(await E(`/admin/review-workflows/workflows/${c}`,{params:{...u,...f}})).data);let w=[];return c&&r?.data?w=[r.data]:Array.isArray(r?.data)&&(w=r.data),{meta:r?.meta??{},workflows:w,isLoading:a,status:s,refetch:o}}},26259:(O,m,t)=>{t.r(m),t.d(m,{default:()=>X});var e=t(67294),n=t(80621),l=t(86706),g=t(36364),E=t(96987),c=t(74863),f=t(5923),u=t(38454),r=t(3547),a=t(29299),s=t(69398),o=t(10574),w=t(22304),p=t(35752),y=t(96208),A=t(83598),W=t(2382),L=t(54425),S=t(86896),I=t(88767),x=t(16550),D=t(54863),v=t(92686),T=t(75021),h=t(43390),R=t(38705),C=t(86978),V=t(52258);const z=(0,D.default)(n.Link)`
  align-items: center;
  height: ${(0,n.pxToRem)(32)};
  display: flex;
  justify-content: center;
  padding: ${({theme:i})=>`${i.spaces[2]}}`};
  width: ${(0,n.pxToRem)(32)};

  svg {
    height: ${(0,n.pxToRem)(12)};
    width: ${(0,n.pxToRem)(12)};

    path {
      fill: ${({theme:i})=>i.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:i})=>i.colors.neutral800};
      }
    }
  }
`;function Y(){const{formatMessage:i}=(0,S.Z)(),{push:K}=(0,x.k6)(),{collectionTypes:J,singleTypes:b,isLoading:q}=(0,v.G)(),{meta:P,workflows:j,isLoading:F,refetch:_}=(0,V.n)(),[U,$]=e.useState(null),[ee,B]=e.useState(!1),{del:te}=(0,n.useFetchClient)(),{formatAPIError:ne}=(0,n.useAPIErrorHandler)(),Z=(0,n.useNotification)(),{getFeature:se,isLoading:G}=(0,T.q)(),{trackUsage:H}=(0,n.useTracking)(),ae=(0,l.useSelector)(g._),{allowedActions:{canCreate:Q,canDelete:oe}}=(0,n.useRBAC)(ae.settings["review-workflows"]),M=se("review-workflows"),{mutateAsync:le,isLoading:re}=(0,I.useMutation)(async({workflowId:d,stages:k})=>{const{data:{data:N}}=await te(`/admin/review-workflows/workflows/${d}`,{data:k});return N},{onSuccess(){Z({type:"success",message:{id:"notification.success.deleted",defaultMessage:"Deleted"}})}}),ie=d=>[...J,...b].find(N=>N.uid===d).info.displayName,de=d=>{$(d)},ce=()=>{$(null)},ue=async()=>{try{const d=await le({workflowId:U});return await _(),$(null),d}catch(d){return Z({type:"warning",message:ne(d)}),null}};return e.useEffect(()=>{!F&&!G&&M?.[C.Ef]&&P?.workflowCount>parseInt(M[C.Ef],10)&&B(!0)},[G,F,M,P?.workflowCount,P.workflowsTotal]),e.createElement(e.Fragment,null,e.createElement(h.h4,{primaryAction:Q&&e.createElement(n.LinkButton,{startIcon:e.createElement(A.Z,null),size:"S",to:"/settings/review-workflows/create",onClick:d=>{M?.[C.Ef]&&P?.workflowCount>=parseInt(M[C.Ef],10)?(d.preventDefault(),B(!0)):H("willCreateWorkflow")}},i({id:"Settings.review-workflows.list.page.create",defaultMessage:"Create new workflow"})),subtitle:i({id:"Settings.review-workflows.list.page.subtitle",defaultMessage:"Manage your content review process"}),title:i({id:"Settings.review-workflows.list.page.title",defaultMessage:"Review Workflows"})}),e.createElement(h.fC,null,F||q?e.createElement(E.k,{justifyContent:"center"},e.createElement(c.a,null,i({id:"Settings.review-workflows.page.list.isLoading",defaultMessage:"Workflows are loading"}))):e.createElement(f.i,{colCount:3,footer:Q&&e.createElement(u.c,{icon:e.createElement(A.Z,null),onClick:()=>{M?.[C.Ef]&&P?.workflowCount>=parseInt(M[C.Ef],10)?B(!0):(K("/settings/review-workflows/create"),H("willCreateWorkflow"))}},i({id:"Settings.review-workflows.list.page.create",defaultMessage:"Create new workflow"})),rowCount:1},e.createElement(r.h,null,e.createElement(a.Tr,null,e.createElement(s.Th,null,e.createElement(o.Z,{variant:"sigma"},i({id:"Settings.review-workflows.list.page.list.column.name.title",defaultMessage:"Name"}))),e.createElement(s.Th,null,e.createElement(o.Z,{variant:"sigma"},i({id:"Settings.review-workflows.list.page.list.column.stages.title",defaultMessage:"Stages"}))),e.createElement(s.Th,null,e.createElement(o.Z,{variant:"sigma"},i({id:"Settings.review-workflows.list.page.list.column.contentTypes.title",defaultMessage:"Content Types"}))),e.createElement(s.Th,null,e.createElement(w.T,null,i({id:"Settings.review-workflows.list.page.list.column.actions.title",defaultMessage:"Actions"}))))),e.createElement(p.p,null,j.map(d=>e.createElement(a.Tr,{...(0,n.onRowClick)({fn(k){k.target.nodeName!=="BUTTON"&&K(`/settings/review-workflows/${d.id}`)}}),key:`workflow-${d.id}`},e.createElement(s.Td,{width:(0,n.pxToRem)(250)},e.createElement(o.Z,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0},d.name)),e.createElement(s.Td,null,e.createElement(o.Z,{textColor:"neutral800"},d.stages.length)),e.createElement(s.Td,null,e.createElement(o.Z,{textColor:"neutral800"},(d?.contentTypes??[]).map(ie).join(", "))),e.createElement(s.Td,null,e.createElement(E.k,{alignItems:"center",justifyContent:"end"},e.createElement(z,{to:`/settings/review-workflows/${d.id}`,"aria-label":i({id:"Settings.review-workflows.list.page.list.column.actions.edit.label",defaultMessage:"Edit {name}"},{name:d.name})},e.createElement(W.Z,null)),j.length>1&&oe&&e.createElement(y.h,{"aria-label":i({id:"Settings.review-workflows.list.page.list.column.actions.delete.label",defaultMessage:"Delete {name}"},{name:"Default workflow"}),icon:e.createElement(L.Z,null),noBorder:!0,onClick:()=>{de(d.id)}}))))))),e.createElement(n.ConfirmDialog,{bodyText:{id:"Settings.review-workflows.list.page.delete.confirm.body",defaultMessage:"If you remove this worfklow, all stage-related information will be removed for this content-type. Are you sure you want to remove it?"},isConfirmButtonLoading:re,isOpen:!!U,onToggleDialog:ce,onConfirm:ue}),e.createElement(R.fC,{isOpen:ee,onClose:()=>B(!1)},e.createElement(R.Dx,null,i({id:"Settings.review-workflows.list.page.workflows.limit.title",defaultMessage:"You\u2019ve reached the limit of workflows in your plan"})),e.createElement(R.uT,null,i({id:"Settings.review-workflows.list.page.workflows.limit.body",defaultMessage:"Delete a workflow or contact Sales to enable more workflows."})))))}function X(){const i=(0,l.useSelector)(g._);return e.createElement(n.CheckPagePermissions,{permissions:i.settings["review-workflows"].main},e.createElement(Y,null))}},38454:(O,m,t)=>{t.d(m,{c:()=>r});var e=t(85893),n=t(54863),l=t(16607),g=t(26910),E=t(96987),c=t(10574);const f=(0,n.default)(l.x)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:a})=>a.colors.primary600};
  }
`,u=(0,n.default)(l.x)`
  border-radius: 0 0 ${({theme:a})=>a.borderRadius} ${({theme:a})=>a.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,r=({children:a,icon:s,...o})=>(0,e.jsxs)("div",{children:[(0,e.jsx)(g.i,{}),(0,e.jsx)(u,{as:"button",background:"primary100",padding:5,...o,children:(0,e.jsxs)(E.k,{children:[(0,e.jsx)(f,{"aria-hidden":!0,background:"primary200",children:s}),(0,e.jsx)(l.x,{paddingLeft:3,children:(0,e.jsx)(c.Z,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:a})})]})})]})}}]);
