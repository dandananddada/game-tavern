"use strict";(self.webpackChunkgame_tavern=self.webpackChunkgame_tavern||[]).push([[2282],{1431:(A,E,t)=>{t.r(E),t.d(E,{ProvidersPage:()=>de,default:()=>Oe});var e=t(67294),o=t(71590),y=t(40720),P=t(90731),O=t(34726),L=t(5923),i=t(3547),h=t(29299),m=t(69398),x=t(10574),S=t(22304),C=t(35752),l=t(96208),a=t(80621),v=t(2382),u=t(11700),f=t.n(u),p=t(86896),j=t(88767),K=t(74622),X=t(36854),$=t(71543),ve=t(96987),fe=t(31988),he=t(6498),pe=t(37022),ae=t(12473),be=t(82392),Ee=t(75071),ye=t(41054),Pe=t(45697),n=t.n(Pe),xe=t(17705),Me=t(38670);const w=({description:c,disabled:z,intlLabel:I,error:B,name:R,onChange:F,placeholder:d,providerToEditName:U,type:Z,value:M})=>{const{formatMessage:b}=(0,p.Z)(),D=R==="noName"?`${window.strapi.backendURL}/api/connect/${U}/callback`:M,W=b({id:I.id,defaultMessage:I.defaultMessage},{provider:U,...I.values}),T=c?b({id:c.id,defaultMessage:c.defaultMessage},{provider:U,...c.values}):"";if(Z==="bool")return e.createElement(xe.s,{"aria-label":R,checked:M,disabled:z,hint:T,label:W,name:R,offLabel:b({id:"app.components.ToggleCheckbox.off-label",defaultMessage:"Off"}),onLabel:b({id:"app.components.ToggleCheckbox.on-label",defaultMessage:"On"}),onChange:H=>{F({target:{name:R,value:H.target.checked}})}});const q=d?b({id:d.id,defaultMessage:d.defaultMessage},{...d.values}):"",_=B?b({id:B,defaultMessage:B}):"";return e.createElement(Me.o,{"aria-label":R,disabled:z,error:_,label:W,name:R,onChange:F,placeholder:q,type:Z,value:D})};w.defaultProps={description:null,disabled:!1,error:"",placeholder:null,value:""},w.propTypes={description:n().shape({id:n().string.isRequired,defaultMessage:n().string.isRequired,values:n().object}),disabled:n().bool,error:n().string,intlLabel:n().shape({id:n().string.isRequired,defaultMessage:n().string.isRequired,values:n().object}).isRequired,name:n().string.isRequired,onChange:n().func.isRequired,placeholder:n().shape({id:n().string.isRequired,defaultMessage:n().string.isRequired,values:n().object}),providerToEditName:n().string.isRequired,type:n().string.isRequired,value:n().oneOfType([n().bool,n().string])};const Le=w,G=({headerBreadcrumbs:c,initialData:z,isSubmiting:I,layout:B,isOpen:R,onSubmit:F,onToggle:d,providerToEditName:U})=>{const{formatMessage:Z}=(0,p.Z)();return R?e.createElement(K.P,{onClose:d,labelledBy:"title"},e.createElement(X.x,null,e.createElement(be.O,{label:c.join(", ")},c.map((M,b,D)=>e.createElement(Ee.$,{isCurrent:b===D.length-1,key:M},M)))),e.createElement(ye.Formik,{onSubmit:M=>F(M),initialValues:z,validationSchema:B.schema,validateOnChange:!1},({errors:M,handleChange:b,values:D})=>e.createElement(a.Form,null,e.createElement($.f,null,e.createElement(ve.k,{direction:"column",alignItems:"stretch",gap:1},e.createElement(fe.r,{gap:5},B.form.map(W=>W.map(T=>e.createElement(he.P,{key:T.name,col:T.size,xs:12},e.createElement(Le,{...T,error:M[T.name],onChange:b,value:D[T.name],providerToEditName:U}))))))),e.createElement(pe.m,{startActions:e.createElement(ae.z,{variant:"tertiary",onClick:d,type:"button"},Z({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(ae.z,{type:"submit",loading:I},Z({id:"global.save",defaultMessage:"Save"}))})))):null};G.defaultProps={initialData:null,providerToEditName:null},G.propTypes={headerBreadcrumbs:n().arrayOf(n().string).isRequired,initialData:n().object,layout:n().shape({form:n().arrayOf(n().array),schema:n().object}).isRequired,isOpen:n().bool.isRequired,isSubmiting:n().bool.isRequired,onSubmit:n().func.isRequired,onToggle:n().func.isRequired,providerToEditName:n().string};const Re=G;var ne=t(84419),g=t(99688),r=t(87561);const re={id:(0,g.OB)("PopUpForm.Providers.redirectURL.front-end.label"),defaultMessage:"The redirect URL to your front-end app"},se={id:"http://www.client-app.com",defaultMessage:"http://www.client-app.com"},Q={id:(0,g.OB)("PopUpForm.Providers.enabled.description"),defaultMessage:"If disabled, users won't be able to use this provider."},J={id:(0,g.OB)("PopUpForm.Providers.enabled.label"),defaultMessage:"Enable"},le={id:(0,g.OB)("PopUpForm.Providers.key.label"),defaultMessage:"Client ID"},ie={id:(0,g.OB)("PopUpForm.Providers.redirectURL.label"),defaultMessage:"The redirect URL to add in your {provider} application configurations"},N={id:(0,g.OB)("PopUpForm.Providers.key.placeholder"),defaultMessage:"TEXT"},oe={id:(0,g.OB)("PopUpForm.Providers.secret.label"),defaultMessage:"Client Secret"},Y={email:{form:[[{intlLabel:J,name:"enabled",type:"bool",description:Q,size:6}]],schema:r.Ry().shape({enabled:r.Xg().required(a.translatedErrors.required)})},providers:{form:[[{intlLabel:J,name:"enabled",type:"bool",description:Q,size:6,validations:{required:!0}}],[{intlLabel:le,name:"key",type:"text",placeholder:N,size:12,validations:{required:!0}}],[{intlLabel:oe,name:"secret",type:"text",placeholder:N,size:12,validations:{required:!0}}],[{intlLabel:re,placeholder:se,name:"callback",type:"text",size:12,validations:{required:!0}}],[{intlLabel:ie,name:"noName",type:"text",validations:{},size:12,disabled:!0}]],schema:r.Ry().shape({enabled:r.Xg().required(a.translatedErrors.required),key:r.Z_().when("enabled",{is:!0,then:r.Z_().required(a.translatedErrors.required),otherwise:r.Z_()}),secret:r.Z_().when("enabled",{is:!0,then:r.Z_().required(a.translatedErrors.required),otherwise:r.Z_()}),callback:r.Z_().when("enabled",{is:!0,then:r.Z_().required(a.translatedErrors.required),otherwise:r.Z_()})})},providersWithSubdomain:{form:[[{intlLabel:J,name:"enabled",type:"bool",description:Q,size:6,validations:{required:!0}}],[{intlLabel:le,name:"key",type:"text",placeholder:N,size:12,validations:{required:!0}}],[{intlLabel:oe,name:"secret",type:"text",placeholder:N,size:12,validations:{required:!0}}],[{intlLabel:{id:(0,g.OB)({id:"PopUpForm.Providers.jwksurl.label"}),defaultMessage:"JWKS URL"},name:"jwksurl",type:"text",placeholder:N,size:12,validations:{required:!1}}],[{intlLabel:{id:(0,g.OB)("PopUpForm.Providers.subdomain.label"),defaultMessage:"Host URI (Subdomain)"},name:"subdomain",type:"text",placeholder:{id:(0,g.OB)("PopUpForm.Providers.subdomain.placeholder"),defaultMessage:"my.subdomain.com"},size:12,validations:{required:!0}}],[{intlLabel:re,placeholder:se,name:"callback",type:"text",size:12,validations:{required:!0}}],[{intlLabel:ie,name:"noName",type:"text",validations:{},size:12,disabled:!0}]],schema:r.Ry().shape({enabled:r.Xg().required(a.translatedErrors.required),key:r.Z_().when("enabled",{is:!0,then:r.Z_().required(a.translatedErrors.required),otherwise:r.Z_()}),secret:r.Z_().when("enabled",{is:!0,then:r.Z_().required(a.translatedErrors.required),otherwise:r.Z_()}),subdomain:r.Z_().when("enabled",{is:!0,then:r.Z_().required(a.translatedErrors.required),otherwise:r.Z_()}),callback:r.Z_().when("enabled",{is:!0,then:r.Z_().required(a.translatedErrors.required),otherwise:r.Z_()})})}},de=()=>{const{formatMessage:c,locale:z}=(0,p.Z)(),I=(0,j.useQueryClient)(),{trackUsage:B}=(0,a.useTracking)(),[R,F]=e.useState(!1),[d,U]=e.useState(null),Z=(0,a.useNotification)(),{lockApp:M,unlockApp:b}=(0,a.useOverlayBlocker)(),{get:D,put:W}=(0,a.useFetchClient)(),{formatAPIError:T}=(0,a.useAPIErrorHandler)(),q=(0,a.useCollator)(z,{sensitivity:"base"});(0,a.useFocusWhenNavigate)();const{isLoading:_,allowedActions:{canUpdate:H}}=(0,a.useRBAC)({update:ne._.updateProviders}),{isLoading:Be,data:ee}=(0,j.useQuery)(["users-permissions","get-providers"],async()=>{const{data:s}=await D("/users-permissions/providers");return s},{initialData:{}}),ue=(0,j.useMutation)(s=>W("/users-permissions/providers",s),{async onSuccess(){await I.invalidateQueries(["users-permissions","providers"]),Z({type:"success",message:{id:(0,g.OB)("notification.success.submit")}}),B("didEditAuthenticationProvider"),te(),b()},onError(s){Z({type:"warning",message:T(s)}),b()},refetchActive:!1}),V=Object.entries(ee).reduce((s,[k,Ze])=>{const{icon:ge,enabled:Se,subdomain:Ie}=Ze;return s.push({name:k,icon:ge==="envelope"?["fas","envelope"]:["fab",ge],enabled:Se,subdomain:Ie}),s},[]).sort((s,k)=>q.compare(s.name,k.name)),Te=Be||_,ce=e.useMemo(()=>d?!!V.find(k=>k.name===d)?.subdomain:!1,[V,d]),Ce=e.useMemo(()=>d==="email"?Y.email:ce?Y.providersWithSubdomain:Y.providers,[d,ce]),te=()=>{F(s=>!s)},me=s=>{H&&(U(s.name),te())},je=async s=>{M(),B("willEditAuthenticationProvider"),ue.mutate({providers:{...ee,[d]:s}})};return e.createElement(o.A,null,e.createElement(a.SettingsPageTitle,{name:c({id:(0,g.OB)("HeaderNav.link.providers"),defaultMessage:"Providers"})}),e.createElement(y.o,null,e.createElement(P.T,{title:c({id:(0,g.OB)("HeaderNav.link.providers"),defaultMessage:"Providers"})}),Te?e.createElement(a.LoadingIndicatorPage,null):e.createElement(O.D,null,e.createElement(L.i,{colCount:3,rowCount:V.length+1},e.createElement(i.h,null,e.createElement(h.Tr,null,e.createElement(m.Th,null,e.createElement(x.Z,{variant:"sigma",textColor:"neutral600"},c({id:"global.name",defaultMessage:"Name"}))),e.createElement(m.Th,null,e.createElement(x.Z,{variant:"sigma",textColor:"neutral600"},c({id:(0,g.OB)("Providers.status"),defaultMessage:"Status"}))),e.createElement(m.Th,null,e.createElement(x.Z,{variant:"sigma"},e.createElement(S.T,null,c({id:"global.settings",defaultMessage:"Settings"})))))),e.createElement(C.p,null,V.map(s=>e.createElement(h.Tr,{key:s.name,...(0,a.onRowClick)({fn:()=>me(s),condition:H})},e.createElement(m.Td,{width:"45%"},e.createElement(x.Z,{fontWeight:"semiBold",textColor:"neutral800"},s.name)),e.createElement(m.Td,{width:"65%"},e.createElement(x.Z,{textColor:s.enabled?"success600":"danger600","data-testid":`enable-${s.name}`},s.enabled?c({id:"global.enabled",defaultMessage:"Enabled"}):c({id:"global.disabled",defaultMessage:"Disabled"}))),e.createElement(m.Td,{...a.stopPropagation},H&&e.createElement(l.h,{onClick:()=>me(s),noBorder:!0,icon:e.createElement(v.Z,null),label:"Edit"})))))))),e.createElement(Re,{initialData:ee[d],isOpen:R,isSubmiting:ue.isLoading,layout:Ce,headerBreadcrumbs:[c({id:(0,g.OB)("PopUpForm.header.edit.providers"),defaultMessage:"Edit Provider"}),f()(d)],onToggle:te,onSubmit:je,providerToEditName:d}))},Oe=()=>e.createElement(a.CheckPagePermissions,{permissions:ne._.readProviders},e.createElement(de,null))},99688:(A,E,t)=>{t.d(E,{YX:()=>P,OB:()=>O.Z});var e=t(41609),o=t.n(e);const P=L=>Object.keys(L).reduce((i,h)=>{const m=L[h].controllers,x=Object.keys(m).reduce((S,C)=>(o()(m[C])||(S[C]=m[C]),S),{});return o()(x)||(i[h]={controllers:x}),i},{});var O=t(58655)},34726:(A,E,t)=>{t.d(E,{D:()=>y});var e=t(85893),o=t(16607);const y=({children:P})=>(0,e.jsx)(o.x,{paddingLeft:10,paddingRight:10,children:P})},90731:(A,E,t)=>{t.d(E,{T:()=>x});var e=t(85893),o=t(67294),y=t(54863);const P=l=>{const a=(0,o.useRef)(null),[v,u]=(0,o.useState)(!0),f=([p])=>{u(p.isIntersecting)};return(0,o.useEffect)(()=>{const p=a.current,j=new IntersectionObserver(f,l);return p&&j.observe(a.current),()=>{p&&j.disconnect()}},[a,l]),[a,v]};var O=t(79698);const L=(l,a)=>{const v=(0,O.W)(a);(0,o.useLayoutEffect)(()=>{const u=new ResizeObserver(v);return Array.isArray(l)?l.forEach(f=>{f.current&&u.observe(f.current)}):l.current&&u.observe(l.current),()=>{u.disconnect()}},[l,v])};var i=t(16607),h=t(96987),m=t(10574);const x=l=>{const a=(0,o.useRef)(null),[v,u]=(0,o.useState)(null),[f,p]=P({root:null,rootMargin:"0px",threshold:0});return L(f,()=>{f.current&&u(f.current.getBoundingClientRect())}),(0,o.useEffect)(()=>{a.current&&u(a.current.getBoundingClientRect())},[a]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{style:{height:v?.height},ref:f,children:p&&(0,e.jsx)(C,{ref:a,...l})}),!p&&(0,e.jsx)(C,{...l,sticky:!0,width:v?.width})]})};x.displayName="HeaderLayout";const S=(0,y.default)(i.x)`
  width: ${({width:l})=>l?`${l/16}rem`:void 0};
  z-index: ${({theme:l})=>l.zIndices[1]};
`,C=o.forwardRef(({navigationAction:l,primaryAction:a,secondaryAction:v,subtitle:u,title:f,sticky:p,width:j,...K},X)=>{const $=typeof u=="string";return p?(0,e.jsx)(S,{paddingLeft:6,paddingRight:6,paddingTop:3,paddingBottom:3,position:"fixed",top:0,right:0,background:"neutral0",shadow:"tableShadow",width:j,"data-strapi-header-sticky":!0,children:(0,e.jsxs)(h.k,{justifyContent:"space-between",children:[(0,e.jsxs)(h.k,{children:[l&&(0,e.jsx)(i.x,{paddingRight:3,children:l}),(0,e.jsxs)(i.x,{children:[(0,e.jsx)(m.Z,{variant:"beta",as:"h1",...K,children:f}),$?(0,e.jsx)(m.Z,{variant:"pi",textColor:"neutral600",children:u}):u]}),v?(0,e.jsx)(i.x,{paddingLeft:4,children:v}):null]}),(0,e.jsx)(h.k,{children:a?(0,e.jsx)(i.x,{paddingLeft:2,children:a}):void 0})]})}):(0,e.jsxs)(i.x,{ref:X,paddingLeft:10,paddingRight:10,paddingBottom:8,paddingTop:l?6:8,background:"neutral100","data-strapi-header":!0,children:[l?(0,e.jsx)(i.x,{paddingBottom:2,children:l}):null,(0,e.jsxs)(h.k,{justifyContent:"space-between",children:[(0,e.jsxs)(h.k,{minWidth:0,children:[(0,e.jsx)(m.Z,{as:"h1",variant:"alpha",...K,children:f}),v?(0,e.jsx)(i.x,{paddingLeft:4,children:v}):null]}),a]}),$?(0,e.jsx)(m.Z,{variant:"epsilon",textColor:"neutral600",as:"p",children:u}):u]})})},71590:(A,E,t)=>{t.d(E,{A:()=>L});var e=t(85893),o=t(54863),y=t(16607);const P=(0,o.default)(y.x)`
  display: grid;
  grid-template-columns: ${({hasSideNav:i})=>i?"auto 1fr":"1fr"};
`,O=(0,o.default)(y.x)`
  overflow-x: hidden;
`,L=({sideNav:i,children:h})=>(0,e.jsxs)(P,{hasSideNav:Boolean(i),children:[i,(0,e.jsx)(O,{paddingBottom:10,children:h})]})},40720:(A,E,t)=>{t.d(E,{o:()=>O});var e=t(85893),o=t(54863),y=t(16607);const P=(0,o.default)(y.x)`
  // To prevent global outline on focus visible to force an outline when Main is focused
  &:focus-visible {
    outline: none;
  }
`,O=({labelledBy:L="main-content-title",...i})=>(0,e.jsx)(P,{"aria-labelledby":L,as:"main",id:"main-content",tabIndex:-1,...i})}}]);
